## 运行阶段类型识别 dynamic_cast

运行阶段类型识别（RTTI）为程序在运行阶段确定对象的类型，只适用于包含虚函数的类

基类指针可以指向派生类对象，如何知道基类指针指向的是哪种派生类对象呢？

dynamic_cast 运算符使用指向基类的指针来生成派生类指针，它不能回答“指针指向的是什么类的对象”的问题，但能回答“是否可以安全地将对象的地址赋给特定的指针”的问题

语法：`派生类指针 = dynamic_cast<派生类类型 *>(基类指针);`

注意：

* dynamic_cast 只适用于包含虚函数的类

* dynamic_cast可以将派生类指针转换为基类指针，这种做法没有任何意义
* dynamic_cast 可以用于引用，但是，没有与空指针对应的引用值，如果转换请求不正确，会出现 bad_cast 异常



## typeid 运算符和 type_info 类

typeid 运算符用于获取数据类型的信息

* `typeid(数据类型)`
* `typeid(变量名或表达式)`

typeid 运算符返回 type_info 类（在头文件\<typeinfo>中定义）的对象的引用

type_info 类的实现随编译器而异，但至少有name()成员函数，该函数返回一个字符串，通常是类名

type_info 重载了 == 和 != 运算符，用于对类型进行比较

注意：

* type_info 的构造函数是 private 属性，也没有拷贝构造函数，所以不能直接实例化，只能由编译器在内部实例化
* 不建议用 name()成员函数返回的字符串作为判断数据类型的依据（编译器可能会转换类型名）
* typeid 运算符可以用于多态场景，在运行阶段识别对象的数据类型
* 假设有表达式typeid(*ptr)，当ptr是空指针时，如果ptr是多态的类型，将引发 bad_typeid 异常
# 网络故障诊断

## 网络连通性测试 ping

ping 可以用来测试本机与目标主机是否连通，连通速度和网络的稳定性

`ping -c 5 -s 1024 目标主机的IP地址(域名)`

-c：表示ping包的个数，windows平台的选项是-n，linux默认一直ping下去，windows默认为4个包

-s：指定ping发送数据的字节数，默认为84字节（56字节数据+28字节报头），最大不超过65535字节，windows平台的选项是-l

重点关注响应时间和丢包率

响应时间单位为毫秒，越小代表网络状态越好

丢包率反映了网络的稳定性

## CentOS禁止ping的设置方法

服务器攻击一般是从 ping 开始，黑客攻击网站前会先ping下服务器，看他是否在线，如果禁止ping，可以一定程度的减少服务器被攻击次数，CentOS系统默认允许ping，可以修改内核参数禁止ping

`vi /etc/sysctl.conf`

在文件末尾加上一句

`net.ipv4.icmp_echo_ignore_all=1`

保存后执行 `sysctl -p`使配置生效

配置生效后，ping服务器得不到相应

## 服务可用性测试 telnet

`telnet 目标主机的IP地址 端口号`

telnet失败的情况有三种

1. 目标主机不存在或没有运行
2. 目标主机没有指定端口的服务
3. 被防火墙拦截